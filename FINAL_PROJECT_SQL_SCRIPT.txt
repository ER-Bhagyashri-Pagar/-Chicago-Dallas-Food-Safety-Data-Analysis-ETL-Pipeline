--
-- ER/Studio Data Architect SQL Code Generation
-- Project :      FINAL_PROJECT_ER_MODEL.DM1
--
-- Date Created : Sunday, April 20, 2025 17:58:41
-- Target DBMS : Snowflake
--

-- 
-- TABLE: DIM_DATE 
--

CREATE TABLE DIM_DATE(
    DATE_SK       NUMBER(10, 0)    NOT NULL,
    DATE          DATE             NOT NULL,
    DAY_NAME      VARCHAR(50)      NOT NULL,
    DAY_ABBR      VARCHAR(3)       NOT NULL,
    DAY_NUM       NUMBER(2, 0)     NOT NULL,
    MONTH_NAME    VARCHAR(50)      NOT NULL,
    MONTH_ABBR    VARCHAR(5)       NOT NULL,
    MONTH_NUM     NUMBER(2, 0)     NOT NULL,
    QTR_NUM       NUMBER(2, 0)     NOT NULL,
    YEAR_NUM      NUMBER(4, 0)     NOT NULL,
    IS_WEEKEND    NUMBER(2, 0)     NOT NULL,
    DI_JOB_ID     VARCHAR(100),
    DI_LOAD_DT    DATETIME,
    CONSTRAINT PK_DATE_SK PRIMARY KEY (DATE_SK) 
)
;



-- 
-- TABLE: DIM_FACILITY 
--

CREATE TABLE DIM_FACILITY(
    FACILITY_SK      NUMBER(15, 0)        NOT NULL,
    FACILITY_TYPE    VARCHAR(15000000)    NOT NULL,
    AKA_NAME         VARCHAR(15000000)    NOT NULL,
    DBA_NAME         VARCHAR(15000000)    NOT NULL,
    DI_JOB_ID        VARCHAR(25)          NOT NULL,
    DI_LOAD_DT       DATE                 NOT NULL,
    CONSTRAINT PK_FACILITY_SK PRIMARY KEY (FACILITY_SK) NOT DEFERRABLE 
)
;



-- 
-- TABLE: DIM_INSPECTION_TYPE 
--

CREATE TABLE DIM_INSPECTION_TYPE(
    INSPECTION_TYPE_SK    NUMBER(30, 0)    NOT NULL,
    INSPECTION_ID         NUMBER(10, 0)    NOT NULL,
    INSPECTION_TYPE       VARCHAR(255)     NOT NULL,
    INSPECTION_RESULT     VARCHAR(500)     NOT NULL,
    DI_JOB_ID             VARCHAR(50)      NOT NULL,
    DI_LOAD_DT            DATETIME         NOT NULL,
    CONSTRAINT PK_INSPECTION_TYPE_SK PRIMARY KEY (INSPECTION_TYPE_SK) NOT DEFERRABLE 
)
;



-- 
-- TABLE: DIM_LOCATION 
--

CREATE TABLE DIM_LOCATION(
    LOCATION_SK    NUMBER(20, 0)    NOT NULL,
    ADDRESS        VARCHAR(200)     NOT NULL,
    CITY           VARCHAR(100)     NOT NULL,
    STATE          VARCHAR(50)      NOT NULL,
    ZIP_CODE       NUMBER(10, 0)    NOT NULL,
    LATITUDE       FLOAT            NOT NULL,
    LONGITUDE      FLOAT            NOT NULL,
    DI_JOB_ID      VARCHAR(100)     NOT NULL,
    DI_LOAD_DT     DATETIME         NOT NULL,
    CONSTRAINT PK2 PRIMARY KEY (LOCATION_SK) 
)
;



-- 
-- TABLE: DIM_VIOLATION 
--

CREATE TABLE DIM_VIOLATION(
    VIOLATION_SK         NUMBER(25, 0)        NOT NULL,
    VIOLATION_CAT_ID     NUMBER(10, 0)        NOT NULL,
    VIOLATION_CAT        VARCHAR(1000)        NOT NULL,
    VIOLATION_COMMENT    VARCHAR(16777216)    NOT NULL,
    DI_JOB_ID            VARCHAR(25)          NOT NULL,
    DI_LOAD_DT           DATETIME,
    CONSTRAINT PK_VIOLATION_SK PRIMARY KEY (VIOLATION_SK) NOT DEFERRABLE 
)
;



-- 
-- TABLE: FCT_INSPECTION 
--

CREATE TABLE FCT_INSPECTION(
    INSPECTION_SK         VARCHAR(50)      NOT NULL,
    LOCATION_SK           NUMBER(20, 0)    NOT NULL,
    FACILITY_SK           NUMBER(15, 0)    NOT NULL,
    INSPECTION_TYPE_SK    NUMBER(30, 0)    NOT NULL,
    VIOLATION_SK          NUMBER(25, 0)    NOT NULL,
    DATE_SK               NUMBER(10, 0)    NOT NULL,
    INSPECTION_SCORE      NUMBER(3, 0)     NOT NULL,
    INSPECTION_RESULT     VARCHAR(25)      NOT NULL,
    INSPECTION_YEAR       NUMBER(4, 0)     NOT NULL,
    VIOLATION_SCORE       INTEGER          NOT NULL,
    RISK_CATEGORY         VARCHAR(10)      NOT NULL,
    DI_JOB_ID             VARCHAR(100)     NOT NULL,
    DI_LOAD_DT            DATETIME         NOT NULL,
    CONSTRAINT PK_INSPECTION_SK PRIMARY KEY (INSPECTION_SK, LOCATION_SK, FACILITY_SK, INSPECTION_TYPE_SK, VIOLATION_SK, DATE_SK) 
)
;



-- 
-- TABLE: FCT_INSPECTION 
--

ALTER TABLE FCT_INSPECTION ADD CONSTRAINT RefDIM_LOCATION15 
    FOREIGN KEY (LOCATION_SK)
    REFERENCES DIM_LOCATION(LOCATION_SK)
;

ALTER TABLE FCT_INSPECTION ADD CONSTRAINT RefDIM_FACILITY18 
    FOREIGN KEY (FACILITY_SK)
    REFERENCES DIM_FACILITY(FACILITY_SK)
;

ALTER TABLE FCT_INSPECTION ADD CONSTRAINT RefDIM_INSPECTION_TYPE19 
    FOREIGN KEY (INSPECTION_TYPE_SK)
    REFERENCES DIM_INSPECTION_TYPE(INSPECTION_TYPE_SK)
;

ALTER TABLE FCT_INSPECTION ADD CONSTRAINT RefDIM_VIOLATION23 
    FOREIGN KEY (VIOLATION_SK)
    REFERENCES DIM_VIOLATION(VIOLATION_SK)
;

ALTER TABLE FCT_INSPECTION ADD CONSTRAINT RefDIM_DATE25 
    FOREIGN KEY (DATE_SK)
    REFERENCES DIM_DATE(DATE_SK)
;


